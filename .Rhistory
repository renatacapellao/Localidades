View(mamiferos_especies)
mamiferos_especies[,1]<- as.character(mamiferos_especies[,1])
View(mamiferos_especies)
mamiferos_especies[,2]<- as.numeric(mamiferos_especies[,2])
summary(mamiferos_especies)
is.data.frame(mamiferos_especies)
is.numeric(mamiferos_especies[,2])
for(i in c(1:length(mamiferos_especies[,1]))){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(is.null(key)){
mamiferos_especies[i,2]<- NULL
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
for(i in c(1:length(mamiferos_especies[,1]))){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(length(key)<1){
mamiferos_especies[i,2]<- NULL
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
length(key)<1
mamiferos_especies[i,2]<- 0
for(i in c(1:length(mamiferos_especies[,1]))){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(length(key)<1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
mamiferos <- read_excel("mamiferos.xlsx")
# peixes <- read_excel("peixes.xlsx")
# repteis <- read_excel("repteis.xlsx")
# aves <- read_excel("aves.xlsx")
# anfibios_especies<- as.data.frame(anfibios)
# anfibios_especies<-anfibios_especies[,2]
# anfibios_especies<-as.factor(anfibios_especies)
mamiferos_especies<- as.data.frame(mamiferos)
mamiferos_especies<-mamiferos_especies[,2]
mamiferos_especies<-levels(as.factor(mamiferos_especies))
sp <-array(dim = c(length(mamiferos_especies),2 ))
sp [,1] <- mamiferos_especies
colnames(sp)<-c("especie", "key" )
mamiferos_especies<- sp
mamiferos_especies<-as.data.frame(mamiferos_especies)
mamiferos_especies[,1]<- as.character(mamiferos_especies[,1])
mamiferos_especies[,2]<- as.numeric(mamiferos_especies[,2])
for(i in c(1:length(mamiferos_especies[,1]))){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(length(key)<1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
View(mamiferos_especies)
for(i in c(1:length(mamiferos_especies[,1]))){
if(key== 0){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(length(key)< 1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
for(i in c(1:length(mamiferos_especies[,1]))){
if(is.na(key)){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(length(key)< 1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
for(i in c(1:length(mamiferos_especies[,1]))){
if(is.na(mamiferos_especies[,2])){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(length(key)< 1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
warnings()
for(i in c(1:length(mamiferos_especies[,1]))){
if(is.na(mamiferos_especies[,2])){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
}
if(length(key)< 1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
for(i in c(1:length(mamiferos_especies[,1]))){
if(is.na(mamiferos_especies[i,2])){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
}
if(length(key)< 1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
for(i in c(1:length(mamiferos_especies[,1]))){
if(is.na(mamiferos_especies[i,2])){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(length(key)< 1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
for(i in c(1:length(mamiferos_especies[,1]))){
# if(is.na(mamiferos_especies[i,2])){
#   key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(length(key)< 1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
# }
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
for(i in c(1:length(mamiferos_especies[,1]))){
# if(is.na(mamiferos_especies[i,2])){
key<- name_backbone(name = mamiferos_especies[i,1])$speciesKey
if(length(key)< 1){
mamiferos_especies[i,2]<- 0
} else{
mamiferos_especies[i,2]<- key
}
# }
print(paste(i, mamiferos_especies[i,1], sep=":"))
}
View(mamiferos_especies)
styler:::style_selection()
gbif_data <- occ_search(taxonKey = mamiferos_especies[i, 2], return = "data", limit = 1000)
names(gbif_data)
ibrary(raster)
# use state bounds from gadm website:
# us = shapefile("USA_adm1.shp")
us <- getData("GADM", country="BR", level=1)
library(raster)
# use state bounds from gadm website:
# us = shapefile("USA_adm1.shp")
us <- getData("GADM", country="BR", level=1)
# use state bounds from gadm website:
# us = shapefile("USA_adm1.shp")
br <- getData("GADM", country="BR", level=1)
library(raster)
# use state bounds from gadm website:
# us = shapefile("USA_adm1.shp")
br <- getData("GADM", country="BRA", level=1)
summary(br)
ES< - br[br$NAME_1 == "Espirito Santo",]
br[br$NAME_1 == "Espirito Santo",]
ES<- br[br$NAME_1 == "Espirito Santo",]
plot(ES)
ES<- br[br$NAME_1 == "Espirito Santo",]
plot(ES)
br[1]
names(br)
names(br$NAME_1)
br$NAME_1
ES<- br[br$NAME_1 == "Espírito Santo",]
plot(ES)
library(raster)
# use state bounds from gadm website:
# us = shapefile("USA_adm1.shp")
BRA.map <- getData("GADM", country="BRA", level=1)
ES.contorno<- BRA.map[BRA.map$NAME_1 == "Espírito Santo",]
plot(ES)
teste<-extent(ES.contorno)
clean <- function(coord, abio) {
if (dim(coord)[2] == 2) {
if (exists("abio")) {
# selecionar os pontos únicos e sem NA
mask = abio[[1]]
# Selecionar pontos espacialmente únicos #
cell <- cellFromXY(mask, coord)  # get the cell number for each point
dup <- duplicated(cell)
pts1 <- coord[!dup, ]  # select the records that are not duplicated
pts1 <- pts1[!is.na(raster::extract(mask, pts1)), ]  #selecionando apenas pontos que tem valor de raster
cat(dim(coord)[1] - dim(pts1)[1], "points removed\n")
cat(dim(pts1)[1], "spatially unique points\n")
names(pts1) = c("Longitude", "Latitude")#
return(pts1)
} else (cat("Indicate the object with the predictive variables"))
} else (stop("Coordinate table has more than two columns.\nThis table should only have longitude and latitude in this order."))
}
library(raster)
# use state bounds from gadm website:
# us = shapefile("USA_adm1.shp")
BRA.map <- getData("GADM", country="BRA", level=1)
ES.contorno<- BRA.map[BRA.map$NAME_1 == "Espírito Santo",]
#plot(ES)
ext<-extent(ES.contorno)
i=1
gbif_data <- subset(gbif_data, !is.na(decimalLongitude) & !is.na(decimalLatitude))
gbif_data <- subset(gbif_data, (decimalLongitude != 0) & (decimalLatitude != 0))
occur.data <- gbif_data[, c(1, 4, 3)]
gbif_data <- occ_search(taxonKey = mamiferos_especies[i, 2], return = "data", limit = 1000)
for(i in c(1:length(gbif_data))){
gbif_data_sub <- subset(gbif_data, !is.na(decimalLongitude) & !is.na(decimalLatitude))
gbif_data_sub <- subset(gbif_data_sub, (decimalLongitude != 0) & (decimalLatitude != 0))
occur.data <- gbif_data_sub[, c(4, 3)]
colnames(occur.data) <- c("Longitude", "Latitude")
}
gbif_data <- occ_search(taxonKey = mamiferos_especies[i, 2], return = "data", limit = 1000)
i=1
mamiferos_especies[i, 2]
gbif_data <- occ_search(taxonKey = mamiferos_especies[i, 2], return = "data", limit = 1000)
gbif_data <- occ_search(taxonKey = 2437892, return = "data", limit = 1000)
gbif_data <- occ_search(taxonKey = 2437892)
(key <- name_suggest(q='Helianthus annuus', rank='species')$key[1])
key <- name_suggest(q='Helianthus annuus', rank='species')$key[1]
library("rgbif", lib.loc = "~/R/R-3.4.4/library")
library(readxl)
# fauna_2005 <- read_excel("2017.05.22 - Especies da fauna ameacadas.xlsx",
#   col_types = c(
#     "numeric", "numeric", "text",
#     "text", "text", "text", "text"
#   ),
#   skip = 1
# )
#
# flora_2005 <- read_excel("2017.05.22 - Especies da flora ameacadas.xlsx",
#   col_types = c(
#     "numeric", "text", "text",
#     "text", "text", "text", "text", "text",
#     "text"
#   )
# )
# anfibios <- read_excel("Anfibios.xlsx")
mamiferos <- read_excel("mamiferos.xlsx")
mamiferos_especies <- mamiferos_especies[, 2]
mamiferos_especies <- mamiferos[, 2]
mamiferos_especies <- levels(as.factor(mamiferos_especies))
mamiferos_especies <- as.data.frame(mamiferos)
mamiferos_especies <- mamiferos_especies[, 2]
mamiferos_especies <- levels(as.factor(mamiferos_especies))
sp <- array(dim = c(length(mamiferos_especies), 2))
sp [, 1] <- mamiferos_especies
colnames(sp) <- c("especie", "key")
mamiferos_especies <- sp
mamiferos_especies <- as.data.frame(mamiferos_especies)
mamiferos_especies[, 1] <- as.character(mamiferos_especies[, 1])
mamiferos_especies[, 2] <- as.numeric(mamiferos_especies[, 2])
library(rgbif)
for (i in c(1:length(mamiferos_especies[, 1]))) {
key <- name_backbone(name = mamiferos_especies[i, 1])$speciesKey
if (length(key) < 1) {
mamiferos_especies[i, 2] <- 0
} else {
mamiferos_especies[i, 2] <- key
}
print(paste(i, mamiferos_especies[i, 1], sep = ":"))
}
View(mamiferos_especies)
getwd()
write.csv(mamiferos_especies, file=" mamiferos_gbifkey.csv",col.names=TRUE,row.names = FALSE )
clean <- function(coord, abio) {
if (dim(coord)[2] == 2) {
if (exists("abio")) {
# selecionar os pontos únicos e sem NA
mask = abio[[1]]
# Selecionar pontos espacialmente únicos #
cell <- cellFromXY(mask, coord)  # get the cell number for each point
dup <- duplicated(cell)
pts1 <- coord[!dup, ]  # select the records that are not duplicated
pts1 <- pts1[!is.na(raster::extract(mask, pts1)), ]  #selecionando apenas pontos que tem valor de raster
cat(dim(coord)[1] - dim(pts1)[1], "points removed\n")
cat(dim(pts1)[1], "spatially unique points\n")
names(pts1) = c("Longitude", "Latitude")#
return(pts1)
} else (cat("Indicate the object with the predictive variables"))
} else (stop("Coordinate table has more than two columns.\nThis table should only have longitude and latitude in this order."))
}
grupos<-c("mamiferos_especies", "aves_especies","anfibios_especies","repteis_especies, peixes_especies")
grupos<-c("mamiferos_especies", "aves_especies","anfibios_especies","repteis_especies", "peixes_especies")
for(g in c(grupos)){
for (i in c(1:length(grupos[, 1]))) {
key <- name_backbone(name = grupos[i, 1])$speciesKey
if (length(key) < 1) {
grupos[i, 2] <- 0
} else {
grupos[i, 2] <- key
}
print(paste(i, grupos[i, 1], sep = ":"))
}
grupos<-c(mamiferos_especies, aves_especies,anfibios_especies,repteis_especies, peixes_especies)
# anfibios <- read_excel("Anfibios.xlsx")
mamiferos <- read_excel("mamiferos.xlsx")
# peixes <- read_excel("peixes.xlsx")
# repteis <- read_excel("repteis.xlsx")
# aves <- read_excel("aves.xlsx")
# anfibios_especies<- as.data.frame(anfibios)
# anfibios_especies<-anfibios_especies[,2]
# anfibios_especies<-as.factor(anfibios_especies)
mamiferos_especies <- as.data.frame(mamiferos)
mamiferos_especies <- mamiferos_especies[, 2]
mamiferos_especies <- levels(as.factor(mamiferos_especies))
sp <- array(dim = c(length(mamiferos_especies), 2))
sp [, 1] <- mamiferos_especies
colnames(sp) <- c("especie", "key")
mamiferos_especies <- sp
mamiferos_especies <- as.data.frame(mamiferos_especies)
mamiferos_especies[, 1] <- as.character(mamiferos_especies[, 1])
mamiferos_especies[, 2] <- as.numeric(mamiferos_especies[, 2])
# peixes_especies<- as.data.frame(peixes)
# peixes_especies<-peixes_especies[,2]
# peixes_especies<-as.factor(peixes_especies)
#
# repteis_especies<- as.data.frame(repteis)
# repteis_especies<-repteis_especies[,2]
# repteis_especies<-as.factor(repteis_especies)
#
# aves_especies<- as.data.frame(aves)
# aves_especies<-aves_especies[,2]
# aves_especies<-as.factor(aves_especies)
grupo<-mamiferos_especies
for (i in c(1:length(grupo[, 1]))) {
key <- name_backbone(name = grupo[i, 1])$speciesKey
if (length(key) < 1) {
grupo[i, 2] <- 0
} else {
grupo[i, 2] <- key
}
print(paste(i, grupo[i, 1], sep = ":"))
}
grupos <- function(x, type) {
switch(type,
mam = mamiferos_especies,
aves = aves_especies,
anf = anfibios_especies)
}
x=mamiferos_especies
grupos(x,"mam")
grupos <- function(x, type) {
switch(type,
"mamiferos_especies" = mamiferos_especies,
"aves_especies" = aves_especies,
"anfibios_especies" = anfibios_especies)
}
x=mamiferos_especies
grupos(x,"mamiferos_especies")[1,1]
grupos(x,"mamiferos_especies")[1,2]
View(mamiferos_especies)
grupos <- function(type) {
switch(type,
"mamiferos_especies" = mamiferos_especies,
"aves_especies" = aves_especies,
"anfibios_especies" = anfibios_especies)
}
grupos("mamiferos_especies")[1,2]
grupos("mamiferos_especies")
grupos<-c("mamiferos_especies", "aves_especies","anfibios_especies","repteis_especies", "peixes_especies")
grupo <- function(type) {
switch(type,
"mamiferos_especies" = mamiferos_especies,
"aves_especies" = aves_especies,
"anfibios_especies" = anfibios_especies,
"repteis_especies" = repteis_especies,
"peixes_especies" = peixes_especies)
}
length(selecionartaxongrupos(grupos)[, 1])
selecionartaxon <- function(type) {
switch(type,
"mamiferos_especies" = mamiferos_especies,
"aves_especies" = aves_especies,
"anfibios_especies" = anfibios_especies,
"repteis_especies" = repteis_especies,
"peixes_especies" = peixes_especies)
}
length(selecionartaxongrupos(grupos)[, 1])
length(selecionartaxon(grupos)[, 1])
id<-selecionar(grupos[1])
selecionar <- function(type) {
switch(type,
"mamiferos_especies" = mamiferos_especies,
"aves_especies" = aves_especies,
"anfibios_especies" = anfibios_especies,
"repteis_especies" = repteis_especies,
"peixes_especies" = peixes_especies)
}
id<-selecionar(grupos[1])
anfibios <- read_excel("Anfibios.xlsx")
peixes <- read_excel("peixes.xlsx")
repteis <- read_excel("repteis.xlsx")
aves <- read_excel("aves.xlsx")
anfibios_especies <- as.data.frame(anfibios)
anfibios_especies <- anfibios_especies[, 2]
anfibios_especies <- levels(as.factor(anfibios_especies))
sp <- array(dim = c(length(anfibios_especies), 2))
sp [, 1] <- anfibios_especies
colnames(sp) <- c("especie", "key")
anfibios_especies <- sp
anfibios_especies <- as.data.frame(anfibios_especies)
anfibios_especies[, 1] <- as.character(anfibios_especies[, 1])
anfibios_especies[, 2] <- as.numeric(anfibios_especies[, 2])
mamiferos_especies <- as.data.frame(mamiferos)
mamiferos_especies <- mamiferos_especies[, 2]
mamiferos_especies <- levels(as.factor(mamiferos_especies))
sp <- array(dim = c(length(mamiferos_especies), 2))
sp [, 1] <- mamiferos_especies
colnames(sp) <- c("especie", "key")
mamiferos_especies <- sp
mamiferos_especies <- as.data.frame(mamiferos_especies)
mamiferos_especies[, 1] <- as.character(mamiferos_especies[, 1])
mamiferos_especies[, 2] <- as.numeric(mamiferos_especies[, 2])
peixes_especies <- as.data.frame(peixes)
peixes_especies <- peixes_especies[, 2]
peixes_especies <- levels(as.factor(peixes_especies))
sp <- array(dim = c(length(peixes_especies), 2))
sp [, 1] <- peixes_especies
colnames(sp) <- c("especie", "key")
peixes_especies <- sp
peixes_especies <- as.data.frame(peixes_especies)
peixes_especies[, 1] <- as.character(peixes_especies[, 1])
peixes_especies[, 2] <- as.numeric(peixes_especies[, 2])
repteis_especies <- as.data.frame(repteis)
repteis_especies <- repteis_especies[, 2]
repteis_especies <- levels(as.factor(repteis_especies))
sp <- array(dim = c(length(repteis_especies), 2))
sp [, 1] <- repteis_especies
colnames(sp) <- c("especie", "key")
repteis_especies <- sp
repteis_especies <- as.data.frame(repteis_especies)
repteis_especies[, 1] <- as.character(repteis_especies[, 1])
repteis_especies[, 2] <- as.numeric(repteis_especies[, 2])
aves_especies <- as.data.frame(aves)
aves_especies <- aves_especies[, 2]
aves_especies <- levels(as.factor(aves_especies))
sp <- array(dim = c(length(aves_especies), 2))
sp [, 1] <- aves_especies
colnames(sp) <- c("especie", "key")
aves_especies <- sp
aves_especies <- as.data.frame(aves_especies)
aves_especies[, 1] <- as.character(aves_especies[, 1])
aves_especies[, 2] <- as.numeric(aves_especies[, 2])
ibrary(rgbif)
grupos<-c("mamiferos_especies", "aves_especies","anfibios_especies","repteis_especies", "peixes_especies")
selecionar <- function(type) {
switch(type,
"mamiferos_especies" = mamiferos_especies,
"aves_especies" = aves_especies,
"anfibios_especies" = anfibios_especies,
"repteis_especies" = repteis_especies,
"peixes_especies" = peixes_especies)
}
for(g in c(grupos)){
id<-selecionar(grupos[g])
for (i in c(1:length(id[, 1]))) {
key <- name_backbone(name = id[i, 1])$speciesKey
if (length(key) < 1) {
id[i, 2] <- 0
} else {
id[i, 2] <- key
}
print(paste(i,id[i, 1], sep = ":"))
}
library(rgbif)
grupos<-c("mamiferos_especies", "aves_especies","anfibios_especies","repteis_especies", "peixes_especies")
selecionar <- function(type) {
switch(type,
"mamiferos_especies" = mamiferos_especies,
"aves_especies" = aves_especies,
"anfibios_especies" = anfibios_especies,
"repteis_especies" = repteis_especies,
"peixes_especies" = peixes_especies)
}
for(g in c(grupos)){
id<-selecionar(grupos[g])
for (i in c(1:length(id[, 1]))) {
key <- name_backbone(name = id[i, 1])$speciesKey
if (length(key) < 1) {
id[i, 2] <- 0
} else {
id[i, 2] <- key
}
print(paste(i,id[i, 1], sep = ":"))
}
c(grupos)
g<-grupos[1]
id <- selecionar(grupos,g)
for(g in c(1:length(grupos))){
id <- selecionar(grupos[g])
for (i in c(1:length(id[, 1]))) {
key <- name_backbone(name = id[i, 1])$speciesKey
if (length(key) < 1) {
id[i, 2] <- 0
} else {
id[i, 2] <- key
}
print(paste(i,id[i, 1], sep = ":"))
}
source('~/GitHub/Localidades/Lista_de_especies.R', encoding = 'UTF-8')
rm(id)
